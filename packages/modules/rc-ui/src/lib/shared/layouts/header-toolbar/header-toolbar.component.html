@if (user) {
<div>
  <!-- Organization trigger -->
  <span
    #popoverOrganizationTarget
    class="inline-block"
  >
    <button
      vcl-button
      [selectable]="true"
      (click)="templatePopoverOrganization.toggle()"
      class="half-transparent"
    >
      <vcl-icon
        vclPrepend
        icon="mdi:home-outline"
      ></vcl-icon>

      {{ selectedOrganization?.name || 'rs-ui.header.org.selectPlaceholder' }}

      <vcl-icon
        vclAppend
        icon="mdi:chevron-down"
      ></vcl-icon>
    </button>
  </span>

  <!-- Account trigger -->
  <span
    #popoverAccountTarget
    class="inline-block"
  >
    <button
      vcl-button
      [selectable]="true"
      (click)="templatePopoverAccount.toggle()"
      class="half-transparent account"
    >
      <vcl-icogram>
        <vcl-icon icon="mdi:account-outline"></vcl-icon>
        {{ user.fullName }}
        <vcl-icon icon="mdi:chevron-down"></vcl-icon>
      </vcl-icogram>
    </button>
  </span>
</div>

<!-- ORG POPOVER -->
<ng-template
  vclPopover
  #templatePopoverOrganization="vclPopover"
  [target]="popoverOrganizationTarget"
  class="mt-2"
  [closeOnOffClick]="true"
  [positions]="rightOrientedPositions"
>
  <div class="rc-header-toolbar-org-popover">
    <!-- Search -->
    <vcl-input-field class="searchField">
      <input
        vclInput
        placeholder="Search organizations..."
        [(ngModel)]="searchTerm"
      />
    </vcl-input-field>

    <!-- Organization list -->
    <vcl-select-list
      class="m-0"
      (valueChange)="
        onSelectOrganization($event); templatePopoverOrganization.close()
      "
    >
      @for (organization of filteredOrganizations; track $index) {
      <vcl-select-list-item
        class="row center"
        [value]="organization.id"
      >
        <div class="p-2">{{ organization?.name }}</div>
      </vcl-select-list-item>
      }
    </vcl-select-list>
  </div>
</ng-template>

<!-- ACCOUNT POPOVER -->
<ng-template
  vclPopover
  #templatePopoverAccount="vclPopover"
  [target]="popoverAccountTarget"
  [closeOnOffClick]="true"
  [positions]="rightOrientedPositions"
>
  <vcl-select-list
    (valueChange)="
      onAccountItemSelected($event); templatePopoverAccount.close()
    "
  >
    @if (showProfile) {
    <vcl-select-list-item value="profile">
      <vcl-icon
        vclPrepend
        icon="mdi:account-cog-outline"
      ></vcl-icon>

      {{ label$(config.accountMenu?.profile || 'Profile') | async }}
    </vcl-select-list-item>
    } @if (showPreferences) {
    <vcl-select-list-item value="preferences">
      <vcl-icon
        vclPrepend
        icon="mdi:cog-outline"
      ></vcl-icon>
      {{ label$(config.accountMenu?.preferences || 'Preferences') | async }}
    </vcl-select-list-item>
    } @if (showSignOut) {
    <vcl-select-list-item value="sign-out">
      <vcl-icon
        vclPrepend
        icon="mdi:logout"
      ></vcl-icon>
      {{ label$(config.accountMenu?.signOut || 'Sign out') | async }}
    </vcl-select-list-item>
    }
  </vcl-select-list>
</ng-template>
}
