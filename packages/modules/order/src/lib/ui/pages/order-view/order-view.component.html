@if (order(); as order) {
<rc-resource-detail
  [title]="'Order details'"
  (back)="goBack()"
  (edit)="editOrder()"
  (delete)="deleteOrder()"
>
  <header class="mb-3 row justify-between">
    <div class="title">
      <h3 class="m-0 mb-1">Order {{ order.id }}</h3>
      <vcl-badge>{{ order.status }}</vcl-badge>
    </div>

    <div class="actions mt-2">
      <!-- slot: add buttons like "Cancel", "Refund", "Resend email" -->
      <button
        vcl-button
        class="emphasized-transparent scale85p"
      >
        Create fulfilment
      </button>

      <button
        vcl-button
        class="ml-2 emphasized-transparent scale85p"
      >
        Create invoice
      </button>
    </div>
    <!--
title, state badge, actions (cancel/refund/mark paid etc.)
-->
  </header>

  <vcl-tab-nav [selectedTabIndex]="0">
    <vcl-tab>
      <vcl-label>Basic</vcl-label>
      <!-- TODO New tab -->
      <p>summay about Orders</p>
    </vcl-tab>
    <vcl-tab>
      <vcl-label>Items</vcl-label>

      <!--

      table" role="listbox-->
      <table
        class="table no-border fixed v-align-middle row-hover-highlight row-selectability"
        role="table"
      >
        <thead>
          <tr role="row">
            <th
              class="w-70p"
              role="columnheader"
              scope="col"
            >
              <span>Item</span>
            </th>

            <th
              class="w-10p"
              role="columnheader"
              scope="col"
              class="text-right"
            >
              <span>Qty</span>
            </th>

            <th
              class="w-10p"
              role="columnheader"
              scope="col"
              class="text-right"
            >
              <span>Unit price</span>
            </th>

            <th
              class="w-10p"
              role="columnheader"
              scope="col"
              class="text-right"
            >
              <span>Total</span>
            </th>
          </tr>
        </thead>
        <tbody>
          @for (item of order.items; track item.id) {
          <tr
            role="row"
            class="row-selectable"
          >
            <td role="cell">{{ item.productName }}</td>
            <td role="cell">{{ item.quantity }}</td>
            <td role="cell">
              {{ item.unitPrice?.amount | number : '1.2-2' | currency : 'EUR' }}
            </td>
            <td role="cell">
              {{
                item.totalPrice?.amount | number : '1.2-2' | currency : 'EUR'
              }}
              <!--
              TODO,
              {{ item.totalPrice?.currency -> SHOULD euro -> EUR }} -->
            </td>
          </tr>
          } @empty {
          <tr>
            <td
              colspan="4"
              class="muted"
            >
              No items in this order
            </td>
          </tr>
          }
        </tbody>
      </table>
    </vcl-tab>
    <vcl-tab>
      <vcl-label>History / Timeline</vcl-label>

      <div class="history">
        @for (h of order.history; track $index) {
        <div class="history-row">
          <div class="muted small">{{ h.code }}</div>
          <div>{{ h.message }}</div>
        </div>
        } @empty {
        <h4>No history available for this Order</h4>
        }
      </div>
    </vcl-tab>
    <vcl-tab>
      <vcl-label>Raw JSON / Meta</vcl-label>

      <div class="raw">
        <div class="muted small">Raw payload</div>
        <pre class="pre">{{ order | json }}</pre>
      </div>
    </vcl-tab>
  </vcl-tab-nav>
</rc-resource-detail>
}
