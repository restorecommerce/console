<vcl-drawer-container class="layout-shell-container">
  <vcl-drawer
    mode="side"
    [opened]="(collapsed$ | async) === false"
  >
    <vcl-navigation>
      <div class="row justify-content-between py-1 px-2">
        <rs-brand
          [brandName]="config.appName"
          [logoUrl]="config.logoUrl"
        />
        <button
          vcl-button
          square
          class="transparent"
          [title]="(collapsed$ | async) ? 'Hide sidebar' : 'Show sidebar'"
          (click)="toggleSidebar()"
        >
          <vcl-icon
            class="scale155p"
            icon="mdi mdi-page-layout-sidebar-left"
          />
        </button>
      </div>
      @for (item of (facade.visibleNavItems$ | async); track $index) {
      <vcl-navigation-item
        [routerLink]="item.route"
        [routerLinkActive]="['selected']"
        (click)="navigate(item); $event.stopPropagation()"
      >
        <vcl-navigation-label>
          <vcl-icogram>
            <vcl-icon
              vclPrepend
              [icon]="item.icon"
            ></vcl-icon>
            {{ item.label }}
          </vcl-icogram>
        </vcl-navigation-label>

        @if (item.children?.length) {
        <vcl-navigation>
          @for (child of item.children; track $index) {
          <vcl-navigation-item
            [routerLink]="child.route"
            [routerLinkActive]="['selected']"
            (click)="navigate(child); $event.stopPropagation()"
          >
            <vcl-navigation-label>
              <vcl-icogram>
                <vcl-icon
                  vclPrepend
                  [icon]="child.icon"
                ></vcl-icon>
                {{ child.label }}
              </vcl-icogram>
            </vcl-navigation-label>
          </vcl-navigation-item>
          }
        </vcl-navigation>
        }
      </vcl-navigation-item>
      }
    </vcl-navigation>
  </vcl-drawer>

  <header class="row align-items-center">
    @if (collapsed$ | async) {
    <button
      vcl-button
      square
      class="transparent"
      [title]="'Show sidebar'"
      (click)="toggleSidebar()"
    >
      <vcl-icon
        class="scale155p"
        icon="mdi mdi-page-layout-sidebar-left"
      />
    </button>
    }

    <rs-breadcrumb
      [rootLabel]="'Home'"
      [rootUrl]="'/'"
      [breadcrumbsToExclude]="['Home']"
    />

    <div class="flex"></div>

    <rs-header-toolbar
      [user]="user$ | async"
      [organizations]="(orgs$ | async) || []"
      [selectedOrganizationId]="selectedOrgId$ | async"
      (organizationSelected)="onOrgSelected($event)"
      (accountAction)="onAccountAction($event)"
    />
  </header>

  <main class="flex rs-main">
    <router-outlet />
  </main>
</vcl-drawer-container>

<ng-content select="rc-footer" />
