<header>
  <h3>User detail</h3>
</header>

<vcl-tab-nav>
  <vcl-tab>
    <vcl-label>Overview</vcl-label>

    <vcl-data-list
      mode="none"
      [noBorder]="true"
    >
      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Name</dt>
          <dd>{{ vm.user.name }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>First name</dt>
          <dd>{{ vm.user.firstName || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Last name</dt>
          <dd>{{ vm.user.lastName || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Email</dt>
          <dd>{{ vm.user.email || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Locale</dt>
          <dd>{{ vm.user.localeId || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Timezone ID</dt>
          <dd>{{ vm.user.timezoneId || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Default scope</dt>
          <dd>{{ vm.user.defaultScope || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Invite</dt>
          <dd>{{ vm.user.invite || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Guest</dt>
          <dd>{{ vm.user.guest || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Activation code</dt>
          <dd>{{ vm.user.activationCode || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Last access</dt>
          <dd>{{ vm.user.lastAccess || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Status</dt>
          <dd>{{ vm.user.lastAccess || '—' }}</dd>
        </div>
      </vcl-data-list-item>
    </vcl-data-list>
  </vcl-tab>
  <vcl-tab>
    <vcl-label>Roles ({{ vm.user.roles?.length || 0 }})</vcl-label>
    <rc-table>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          @for (r of vm.user.roles ?? []; track r.id) {
          <tr>
            <td>{{ r.id }}</td>
            <td>{{ r.name }}</td>
            <td>{{ r.description || '—' }}</td>
          </tr>
          }
        </tbody>
      </table>
    </rc-table>
  </vcl-tab>
  <vcl-tab>
    <vcl-label
      >Role Associations ({{ vm.user.roleAssociations.length || 0 }})</vcl-label
    >
    <rc-table>
      <table>
        <thead>
          <tr>
            <th>Role</th>
            <th>Attributes</th>
          </tr>
        </thead>
        <tbody>
          @for (ra of vm.user.roleAssociations; track ra.id) {
          <tr>
            <td>{{ ra.role }}</td>
            <td>
              @if (attrPairs(ra.attributes).length) {
              <vcl-data-list
                mode="none"
                [noBorder]="true"
              >
                @for (p of attrPairs(ra.attributes); track p.id) {
                <vcl-data-list-item>
                  <div class="row align-items-center">
                    <span>{{ p.path }}:</span>
                    <code>{{ p.value || '—' }}</code>
                  </div>
                </vcl-data-list-item>
                }
              </vcl-data-list>
              } @else { — }
            </td>
          </tr>
          }
        </tbody>
      </table>
    </rc-table>
  </vcl-tab>
  <vcl-tab>
    <vcl-label>Tokens ({{ vm.user.tokens.length || 0 }})</vcl-label>
    <rc-table>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Token</th>
            <th>Last Login</th>
            <th>Interactive</th>
            <th>Expires In</th>
            <th>Client ID</th>
            <th>Type</th>
            <th>Scopes</th>
          </tr>
        </thead>
        <tbody>
          @for (token of vm.user.tokens; track token.token ) {
          <tr>
            <td>{{ token.name }}</td>
            <td>{{ token.token }}</td>
            <td>
              {{
                token.lastLogin
                  ? (token.lastLogin | date : DATE.format.dateTime)
                  : '—'
              }}
            </td>
            <td>
              {{
                token.interactive === null || token.interactive === undefined
                  ? '—'
                  : token.interactive
                  ? 'Yes'
                  : 'No'
              }}
            </td>
            <td>
              {{
                token.expiresIn
                  ? (token.expiresIn | date : DATE.format.dateTime)
                  : '—'
              }}
            </td>
            <td>{{ token.clientId || '—' }}</td>
            <td>{{ token.type || '—' }}</td>
            <td>{{ (token.scopes || []).join(', ') || '—' }}</td>
          </tr>
          }
        </tbody>
      </table>
    </rc-table>
  </vcl-tab>

  <vcl-tab>
    <vcl-tab-label> Meta </vcl-tab-label>

    <vcl-data-list
      mode="none"
      [noBorder]="true"
    >
      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>ID</dt>
          <dd>{{ vm.user.id }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Created</dt>
          <dd>{{ vm.user.meta.created | date : 'medium' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Modified</dt>
          <dd>{{ vm.user.meta.modified | date : 'medium' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Created By</dt>
          <dd>{{ vm.user.meta.createdBy || '—' }}</dd>
        </div>
      </vcl-data-list-item>

      <vcl-data-list-item>
        <div class="row justify-between align-items">
          <dt>Modified By</dt>
          <dd>{{ vm.user.meta.modifiedBy || '—' }}</dd>
        </div>
      </vcl-data-list-item>
    </vcl-data-list>
  </vcl-tab>
</vcl-tab-nav>
