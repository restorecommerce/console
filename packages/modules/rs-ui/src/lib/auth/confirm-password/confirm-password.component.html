<rs-auth-page>
  <h2>Confirm Password</h2>
  <p>
    Please provide the necessary information to complete your password
    confirmation.
  </p>

  @if(routerParams$ | async) {
  <form
    vclForm
    class="form"
    [formGroup]="form"
    (ngSubmit)="onClickConfirm()"
  >
    <vcl-form-control-group>
      <vcl-label>Email or Username</vcl-label>
      <vcl-input-field>
        <input
          vclInput
          class="input"
          [class.error]="
            formFields.identifier.hasError('required') &&
            formFields.identifier.touched
          "
          formControlName="identifier"
          type="text"
          name="identifier"
          readonly
        />
      </vcl-input-field>
      <vcl-hint-error error="required">
        This field is required.
      </vcl-hint-error>
    </vcl-form-control-group>

    <vcl-form-control-group>
      <vcl-label>Password</vcl-label>
      <vcl-password-input>
        <input
          vclInput
          class="input"
          [class.error]="
            formFields.password.hasError('required') &&
            formFields.password.touched
          "
          type="password"
          formControlName="password"
          name="password"
          autocomplete="false"
          minlength="6"
          maxlength="20"
        />
      </vcl-password-input>
      <vcl-hint-error error="required">
        This field is required.
      </vcl-hint-error>
      <vcl-hint-error error="pattern">This field must: </vcl-hint-error>
      <vcl-hint-error error="pattern">
        - have at least 6 characters length
      </vcl-hint-error>
      <vcl-hint-error error="pattern">
        - contain a lowercase letter
      </vcl-hint-error>
      <vcl-hint-error error="pattern">
        - contain a uppercase letter
      </vcl-hint-error>
      <vcl-hint-error error="pattern"> - contain a number </vcl-hint-error>
      <vcl-hint-error error="pattern">
        - contain a special character
      </vcl-hint-error>
    </vcl-form-control-group>

    <vcl-form-control-group>
      <vcl-label>Confirm password</vcl-label>
      <vcl-password-input>
        <input
          vclInput
          class="input"
          [class.error]="
            formFields.passwordConfirmation.hasError('required') &&
            formFields.passwordConfirmation.touched
          "
          type="password"
          formControlName="passwordConfirmation"
          name="passwordConfirmation"
        />
      </vcl-password-input>
      <vcl-hint-error error="required">
        This field is required.
      </vcl-hint-error>

      @if ( !formFields.password.hasError('required') &&
      form.hasError('passwordConfirmationMismatch')) {
      <vcl-hint-error>
        Fields Password and Confirm password must match.
      </vcl-hint-error>
      }
    </vcl-form-control-group>

    <div class="align-right">
      <button
        vcl-button
        type="button"
        class="transparent mr-2"
        (click)="onReset()"
      >
        Reset
      </button>

      <button
        vcl-button
        type="submit"
      >
        Confirm password
      </button>
    </div>
  </form>
  }
</rs-auth-page>
